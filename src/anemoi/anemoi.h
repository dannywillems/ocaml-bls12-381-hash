#ifndef ANEMOI_H
#define ANEMOI_H

#define INPUT_SIZE_1 1
#define NB_ROUNDS_128BITS_INPUT_SIZE_1 19
// Nb constants (2 * l * NB ROUNDS) + State size (l * 2)
#define NB_CONSTANTS_128BITS_INPUT_SIZE_1                                      \
  (NB_ROUNDS_128BITS_INPUT_SIZE_1 * 2 * INPUT_SIZE_1)

#include "blst.h"
#include "blst_misc.h"
#include <string.h>

typedef struct anemoi_ctxt_s {
  // state_size := m = 2 * l
  int l;
  int nb_rounds;
  // State + MDS + constants
  blst_fr *ctxt;
} anemoi_ctxt_t;

/*
  Constants have been generated using
  https://github.com/vesselinux/anemoi-hash/commit/6dbe01db361187fe9ea1853a54fdc832783c8dc5
  and the call to the function
      test_jive(
        n_tests=10,
        q=52435875175126190479447740508185965837690552500527637822603658699938581184513,
        alpha=5,
        n_rounds=19,
        n_cols=1,
        b=2,
        security_level=128)
  The number of rounds 19 comes from the paper.

  The values given by the script are (formatted as Fr.t list list):
  ```ocaml
  let c =
    [ [ "39"];
      ["41362478282768062297187132445775312675360473883834860695283235286481594490621"];
      ["9548818195234740988996233204400874453525674173109474205108603996010297049928"];
      ["25365440569177822667580105183435418073995888230868180942004497015015045856900"];
      ["34023498397393406644117994167986720327178154686105264833093891093045919619309"];
      ["38816051319719761886041858113129205506758421478656182868737326994635468402951"];
      ["35167418087531820804128377095512663922179887277669504047069913414630376083753"];
      ["25885868839756469722325652387535232478219821850603640827385444642154834700231"];
      ["8867588811641202981080659274007552529205713737251862066053445622305818871963"];
      ["36439756010140137556111047750162544185710881404522379792044818039722752946048"];
      ["7788624504122357216765350546787885309160020166693449889975992574536033007374"];
      ["3134147137704626983201116226440762775442116005053282329971088789984415999550"]
  ]
  ```
  ```ocaml

  ```
  and you can print the list below using these functions:
  ```ocaml
  let fmt_montgomery v =
    let x0, x1, x2, x3 =
      Bls12_381.Fr.(to_montgomery_le (of_string v))
    in
    Printf.sprintf
      "{.l = {%sul, %sul, %sul, %sul}}"
      (Unsigned.UInt64.to_string x0)
      (Unsigned.UInt64.to_string x1)
      (Unsigned.UInt64.to_string x2)
      (Unsigned.UInt64.to_string x3);;

  let print_list l =
    List.iteri
      (fun i xs ->
        let x = List.nth xs 0 in
        Printf.printf
          "// D%d\n// %s\n%s\n"
          i
          x
          (fmt_montgomery x)
      ) l;;
  ```

  alp
*/

// These are always the same for BLS12-381
// beta = g = first multiplicative generator = 7.
// NB: in the paper, page 17, another matrix is used:
// (1  2)
// (2  5)
static blst_fr BETA = {.l = {64424509425ul, 1721329240476523535ul,
                             18418692815241631664ul, 3824455624000121028ul}};
// delta = g^(-1)
// 14981678621464625851270783002338847382197300714436467949315331057125308909861
static blst_fr DELTA = {.l = {15811494917868205788ul, 16624336857528583898ul,
                              17920762862402342329ul, 7408687358795335574ul}};

// These values depend on the input size
static blst_fr ANEMOI_JIVE_ROUND_CONSTANTS_128BITS_INPUT_SIZE_1[NB_CONSTANTS_128BITS_INPUT_SIZE_1] = {
    // We interleave the constants C and D two by two
    // C0
    // 39
    {.l = {369367187370ul, 16017869003301918806ul, 14596568043751566901ul,
           1020568960729868734ul}},
    // D0
    // 14981678621464625851270783002338847382197300714436467949315331057125308909900
    {.l = {15811495291530360453ul, 8161302378582868785ul,
           10379367933804585962ul, 75739460060754957ul}},
    // C1
    // 41362478282768062297187132445775312675360473883834860695283235286481594490621
    {.l = {4170577526725354068ul, 4990770701190068081ul, 8336778931102778399ul,
           5505266389556783204ul}},
    // D1
    // 28253420209785428420233456008091632509255652343634529984400816700490470131093
    {.l = {9630914107757380667ul, 1258475103464374059ul, 4074185220593392298ul,
           2639960786484139527ul}},
    // C2
    // 9548818195234740988996233204400874453525674173109474205108603996010297049928
    {.l = {4594269610319771864ul, 9435151576635994940ul, 1996026795751277144ul,
           1560452788112133970ul}},
    // D2
    // 51511939407083344002778208487678590135577660247075600880835916725469990319313
    {.l = {7264967206210849666ul, 16143827440029857477ul, 110968098420048789ul,
           6404000683805083012ul}},
    // C3
    // 25365440569177822667580105183435418073995888230868180942004497015015045856900
    {.l = {16701346582019821453ul, 13953512793775924772ul,
           16163997651080395250ul, 6692900632066781842ul}},
    // D3
    // 46291121544435738125248657675097664742296276807186696922340332893747842754587
    {.l = {9806438281233376676ul, 931394924840213202ul, 9442264819348743323ul,
           5082353730523088669ul}},
    // C4
    // 34023498397393406644117994167986720327178154686105264833093891093045919619309
    {.l = {17611586257334538985ul, 15038277307584776375ul,
           3631056021132162359ul, 7181491060146042676ul}},
    // D4
    // 3650460179273129580093806058710273018999560093475503119057680216309578390988
    {.l = {17793909203631489560ul, 4784360104263992357ul, 8780195383945059211ul,
           4670215763352262479ul}},
    // C5
    // 38816051319719761886041858113129205506758421478656182868737326994635468402951
    {.l = {12583552058373933138ul, 10371266354002895826ul,
           2467657739571197716ul, 1023031118688406750ul}},
    // D5
    // 45802223370746268123059159806400152299867771061127345631244786118574025749328
    {.l = {4745334327031885054ul, 15027568145872437618ul, 6820396973286859559ul,
           5523551184219637481ul}},
    // C6
    // 35167418087531820804128377095512663922179887277669504047069913414630376083753
    {.l = {14146724836681663134ul, 8862133116684579525ul,
           10429737528937167448ul, 8288047545532538868ul}},
    // D6
    // 11798621276624967315721748990709309216351696098813162382053396097866233042733
    {.l = {12449731538627387747ul, 12531632181757593559ul,
           14222486200825963925ul, 7203063445117709109ul}},
    // C7
    // 25885868839756469722325652387535232478219821850603640827385444642154834700231
    {.l = {2267425026694936390ul, 14404046692004012683ul,
           10432866881286212694ul, 988788385724671624ul}},
    // D7
    // 42372918959432199162670834641599336326433006968669415662488070504036922966492
    {.l = {15726611089689556459ul, 5795507155888605609ul, 3445565931366403624ul,
           1543995368721623802ul}},
    // C8
    // 8867588811641202981080659274007552529205713737251862066053445622305818871963
    {.l = {9278075440598710854ul, 12294599707394996737ul,
           14037665908864262709ul, 1851526354064786992ul}},
    // D8
    // 52181371244193189669553521955614617990714056725501643636576377752669773323445
    {.l = {5418445239864971111ul, 8754123880678542319ul, 3762767805934597682ul,
           3030763056320236985ul}},
    // C9
    // 36439756010140137556111047750162544185710881404522379792044818039722752946048
    {.l = {8176747803545890748ul, 3781551995455757149ul, 14489398713649572375ul,
           7653155928373156472ul}},
    // D9
    // 23791984554824031672195249524658580601428376029501889159059009332107176394097
    {.l = {10725566008572110773ul, 9300819939267475066ul,
           10713409829943209400ul, 8090793562345106443ul}},
    // C10
    // 7788624504122357216765350546787885309160020166693449889975992574536033007374
    {.l = {8740150973807756747ul, 5132003394075444975ul, 15161625327465921492ul,
           3828904568922565607ul}},
    // D10
    // 33342520831620303764059548442834699069640109058400548818586964467754352720368
    {.l = {8048872697722111699ul, 6586539522841126025ul, 3522530155149444520ul,
           6701144923734735709ul}},
    // C11
    // 3134147137704626983201116226440762775442116005053282329971088789984415999550
    {.l = {14221304550361053777ul, 17473759545749530400ul,
           16573058136738985576ul, 4067185459711892582ul}},
    // D11
    // 16791548253207744974576845515705461794133799104808996134617754018912057476556
    {.l = {14575492187598484303ul, 12453671724463651192ul,
           8246713543931304816ul, 4201146543640855641ul}},
    // C12
    // 50252287380741824818995733304361249016282047978221591906573165442023106203143
    {.l = {8362316204439224602ul, 5577252700882246336ul, 5055272325399647015ul,
           7642843202726798499ul}},
    // D12
    // 11087343419860825311828133337767238110556416596687749174422888171911517001265
    {.l = {13502703954848284088ul, 3943768041816546787ul, 131039509156825481ul,
           3120073282795300045ul}},
    // C13
    // 48434698978712278012409706205559577163572452744833134361195687109159129985373
    {.l = {17988864203834009837ul, 9118104227235696829ul,
           10104371015638660658ul, 1918713587088085605ul}},
    // D13
    // 11931207770538477937808955037363240956790374856666237106403111503668796872571
    {.l = {8986897760763454771ul, 7089904431347670909ul, 2139814013374435106ul,
           7716378250245333616ul}},
    // C14
    // 32960510617530186159512413633821386297955642598241661044178889571655571939473
    {.l = {8360704106197291856ul, 4436663908069900342ul, 12210521579202648519ul,
           511843160031525084ul}},
    // D14
    // 3296943608590459582451043049934874894049468383833500962645016062634514172805
    {.l = {14022542500526828544ul, 12912847913272576175ul,
           9317208712459648801ul, 86263961955415746ul}},
    // C15
    // 12850897859166761094422335671106280470381427571695744605265713866647560628356
    {.l = {12579013181154747171ul, 2060841214762274663ul, 721551750131023491ul,
           4053551778778928434ul}},
    // D15
    // 7080580976521357573320018355401935489220216583936865937104131954142364033647
    {.l = {10013221635359120038ul, 16177267925742072462ul,
           11838565692419617256ul, 3780202431764725053ul}},
    // C16
    // 14578036872634298798382048587794204613583128573535557156943783762854124345644
    {.l = {490885040354948897ul, 3928912523636728580ul, 11620008694755109018ul,
           5567022720363307848ul}},
    // D16
    // 25990144965911478244481527888046366474489820502460615136523859419965697796405
    {.l = {7082935381019747451ul, 13409420108194203116ul, 2162895577432005ul,
           5237983099801576675ul}},
    // C17
    // 21588109842058901916690548710649523388049643745013696896704903154857389904594
    {.l = {17221958730099159510ul, 2012012309820784034ul, 5840394014031503079ul,
           1632822489449101207ul}},
    // D17
    // 33907313384235729375566529911940467295099705980234607934575786561097199483218
    {.l = {13635259357895193414ul, 7503773473633967881ul, 7337684202619391550ul,
           852357166818562430ul}},
    // C18
    // 35731638686520516424752846654442973203189295883541072759390882351699754104989
    {.l = {12101411954634896752ul, 4045609701959667708ul,
           18118227478942048702ul, 6933617356541239082ul}},
    // D18
    // 25996950265608465541351207283024962044374873682152889814392533334239395044136
    {.l = {12027257987959925002ul, 10811558767416674265ul,
           8451328163049581367ul, 4860546105390490080ul}}

};
static blst_fr ANEMOI_ROUND_CONSTANTS_C[76] = {
    // C0
    // 39
    {.l = {369367187370ul, 16017869003301918806ul, 14596568043751566901ul,
           1020568960729868734ul}},
    // C1
    // 17756515227822460609684409997111995494590448775258437999344446424780281143353
    {.l = {10253348816570310500ul, 15092217697679942025ul,
           1810345740164072179ul, 3294015932497092169ul}},
    // C2
    // 10188916128123599964772546147951904500865009616764646948187915341627970346879
    {.l = {1428009078302131137ul, 11961883768154609022ul, 2521306373800578220ul,
           7932887768730976650ul}},
    // C3
    // 3814237141406755457246679946340702245820791055503616462386588886553626328449
    {.l = {3561480940449013440ul, 11591052469126493149ul, 352520938651709888ul,
           1868604607496336035ul}},
    // C4
    // 41362478282768062297187132445775312675360473883834860695283235286481594490621
    {.l = {4170577526725354068ul, 4990770701190068081ul, 8336778931102778399ul,
           5505266389556783204ul}},
    // C5
    // 3384073892082712848969991795331397937188893616190315628722966662742467187281
    {.l = {561887441213697500ul, 6700395553569166464ul, 6698850932794646509ul,
           7552913675240770143ul}},
    // C6
    // 38536464596998108028197905645250196649287447208374169339784649587982292038621
    {.l = {12368030554394315726ul, 1267033892262451673ul,
           13106062683273788355ul, 5009724000902940852ul}},
    // C7
    // 37592197675289757358471908199906415982484124338112374453435292524131427342810
    {.l = {11650357847354428205ul, 15037833281360218230ul,
           6963521746872982639ul, 3930184378387632315ul}},
    // C8
    // 9548818195234740988996233204400874453525674173109474205108603996010297049928
    {.l = {4594269610319771864ul, 9435151576635994940ul, 1996026795751277144ul,
           1560452788112133970ul}},
    // C9
    // 51311880822158488881090781617710146800056386303122657365679608608648067582435
    {.l = {16740817450055051757ul, 5353718766673126685ul,
           13268351495979219631ul, 4083298516975341785ul}},
    // C10
    // 24596965950552905296088269899880882549715354660832391374009234980535928382152
    {.l = {9526800051979946313ul, 17797708954292119689ul,
           10363082805817168867ul, 1946132541507589746ul}},
    // C11
    // 34036826250287807194659359129722586818079652442547178531030410684351456041117
    {.l = {16444561736354284667ul, 17102119652684293682ul,
           6882574504786938647ul, 3207986413851832531ul}},
    // C12
    // 25365440569177822667580105183435418073995888230868180942004497015015045856900
    {.l = {16701346582019821453ul, 13953512793775924772ul,
           16163997651080395250ul, 6692900632066781842ul}},
    // C13
    // 29347609441914902330741511702270026847909178228078752565372729158237774700914
    {.l = {12018092615168539776ul, 4798092232054960055ul, 2510868223907847645ul,
           5667563419203663961ul}},
    // C14
    // 14356478667385969079309349540394948109414829921001045845599553435706989367858
    {.l = {6497383940907723750ul, 7831004685511114126ul, 4490889415336829647ul,
           5563263247864514170ul}},
    // C15
    // 9488013611624811735432450930006811652991761655550510302915118428283918068143
    {.l = {9407773273948332027ul, 4041004343409712318ul, 9145202384324985731ul,
           2160788071267841532ul}},
    // C16
    // 34023498397393406644117994167986720327178154686105264833093891093045919619309
    {.l = {17611586257334538985ul, 15038277307584776375ul,
           3631056021132162359ul, 7181491060146042676ul}},
    // C17
    // 2339620320400167830454536231899316133967303509954474267430948538955691907104
    {.l = {2996076328389593379ul, 3128244281845503814ul, 10617205519569588538ul,
           2700087205462831784ul}},
    // C18
    // 12136748919666286297989154404429099226154686992028401568133058190732008277996
    {.l = {1444003196023635146ul, 17868220165932023405ul, 4431334199463876469ul,
           8321421698821054321ul}},
    // C19
    // 19442569822772655270268482835742480365499256802520510905846953360427433130058
    {.l = {4365752777380337895ul, 12924330214557505937ul, 8979945026653492854ul,
           4655119306689067983ul}},
    // C20
    // 38816051319719761886041858113129205506758421478656182868737326994635468402951
    {.l = {12583552058373933138ul, 10371266354002895826ul,
           2467657739571197716ul, 1023031118688406750ul}},
    // C21
    // 27338042530319738113354246208426108832239651080023276643867223794985578055610
    {.l = {17350458190686192357ul, 2683424815747194524ul, 5123391239021525708ul,
           3456760704425523996ul}},
    // C22
    // 15580674179713644540398409523441814073810768449493940562136422009899312699155
    {.l = {4961126478271318787ul, 13327865478950826419ul,
           11979772873161815304ul, 823314437408800416ul}},
    // C23
    // 4362660876979205605782410963041525734654031488177761934879852229226211686053
    {.l = {1562350452663519950ul, 16175541546934129475ul, 4753313353056680628ul,
           6048741016620032714ul}},
    // C24
    // 35167418087531820804128377095512663922179887277669504047069913414630376083753
    {.l = {14146724836681663134ul, 8862133116684579525ul,
           10429737528937167448ul, 8288047545532538868ul}},
    // C25
    // 42192983528513372869128514327443204912824559545179630597589572656156258515752
    {.l = {2169173858760523096ul, 16416020784911915530ul, 5227571901587454268ul,
           7725221235044315352ul}},
    // C26
    // 47389212411441573266379092392931599970417884729397156841216318364858334633325
    {.l = {8956881410066182386ul, 1601148579793684201ul, 9596221475718892189ul,
           4613346914731086457ul}},
    // C27
    // 41487656259632727393098274178738763934249662924287956242704596746920012242443
    {.l = {10592584092618322566ul, 11850536055838205788ul,
           4641727207079167985ul, 2936905393156100521ul}},
    // C28
    // 25885868839756469722325652387535232478219821850603640827385444642154834700231
    {.l = {2267425026694936390ul, 14404046692004012683ul,
           10432866881286212694ul, 988788385724671624ul}},
    // C29
    // 42721818980548514490325424436763032046927347769153393863616095871384405840432
    {.l = {8297976513684368564ul, 3228320704358840759ul, 293804499737198973ul,
           4911791268361659739ul}},
    // C30
    // 5855288403637341107158034195599277569854359593529752399086836976954392351035
    {.l = {4616354466043635553ul, 1177543044818227145ul, 8570073145684470308ul,
           3616209453147664273ul}},
    // C31
    // 18845851722124019325834426094831743068408557621685658713002749358354699910772
    {.l = {2212354269375277646ul, 13659506524113737325ul,
           14631544533119633711ul, 2248409526343352341ul}},
    // C32
    // 8867588811641202981080659274007552529205713737251862066053445622305818871963
    {.l = {9278075440598710854ul, 12294599707394996737ul,
           14037665908864262709ul, 1851526354064786992ul}},
    // C33
    // 23473499332437056484066006746048591864129988909190267521144125882222313735740
    {.l = {8058668677236989521ul, 9764765033850385335ul, 8202137144258764411ul,
           3230349668231514966ul}},
    // C34
    // 5696063807157149622355481994320806474692190935543821893362808351446578125354
    {.l = {17485329814104238202ul, 10808624572361991460ul,
           13833809960522341806ul, 2280464607758483648ul}},
    // C35
    // 48558031599255072862103809681060565464555437399403822458902024251997890071747
    {.l = {16485287233999168193ul, 5717280567394482490ul,
           10639357393931658755ul, 7349011325469783807ul}},
    // C36
    // 36439756010140137556111047750162544185710881404522379792044818039722752946048
    {.l = {8176747803545890748ul, 3781551995455757149ul, 14489398713649572375ul,
           7653155928373156472ul}},
    // C37
    // 16497366583607480604161417644040292299204496829635795525393416854929276060989
    {.l = {17971030290410246620ul, 14424116756158938264ul,
           16841503490168250944ul, 2650735272830501248ul}},
    // C38
    // 31479323495970113713816467604460499675889579912370034974841212556442942086146
    {.l = {865907912376850080ul, 4842251880744123809ul, 6181520203766125869ul,
           8117958763193356508ul}},
    // C39
    // 52327065242455117582590188333899352706031813782154293138553490341266149456684
    {.l = {15308871573848262861ul, 7379910912611835403ul, 5034075081706120662ul,
           2119858558696017022ul}},
    // C40
    // 7788624504122357216765350546787885309160020166693449889975992574536033007374
    {.l = {8740150973807756747ul, 5132003394075444975ul, 15161625327465921492ul,
           3828904568922565607ul}},
    // C41
    // 16727395967350522643500778393489915391834352737211416857240725807058479128000
    {.l = {1363656024078181426ul, 1464099823488922768ul, 4241671115215412093ul,
           7946918872919762328ul}},
    // C42
    // 23309928720180143362408827385573327479858409115358010770730151873313341134036
    {.l = {15554371108225284043ul, 7530730723395494951ul, 6926103546072226202ul,
           1788429503510852064ul}},
    // C43
    // 50067221443187587661574090167146914206862394380328488561819141296175188378275
    {.l = {5056597779852271928ul, 728224243077348947ul, 1314007366181627220ul,
           3567129164211045367ul}},
    // C44
    // 3134147137704626983201116226440762775442116005053282329971088789984415999550
    {.l = {14221304550361053777ul, 17473759545749530400ul,
           16573058136738985576ul, 4067185459711892582ul}},
    // C45
    // 46525506418681456193255596516104416743523037046982280449529426136392814992763
    {.l = {14624916865667254652ul, 10621523760501089203ul,
           14310468530920986196ul, 4412223979480972250ul}},
    // C46
    // 49173726739193834431163563658537303836196227863071274122448243716476847774081
    {.l = {11324403037339190245ul, 12926408237683439693ul,
           9848378710328693746ul, 5254475588939891659ul}},
    // C47
    // 29046982289309321832219638744094773109240645964319387745189941342957948119206
    {.l = {6850246462938127634ul, 2151181088483796412ul, 16940489671150892604ul,
           3282797852427621990ul}},
    // C48
    // 50252287380741824818995733304361249016282047978221591906573165442023106203143
    {.l = {8362316204439224602ul, 5577252700882246336ul, 5055272325399647015ul,
           7642843202726798499ul}},
    // C49
    // 46030886964045328670650579467522042981756109464584907077434772786649263902996
    {.l = {16431957289331103249ul, 1530427511415935583ul, 3521503429956982827ul,
           8104537134456115067ul}},
    // C50
    // 47125716430962246750225343878325061379201112039537908060878336544274638889887
    {.l = {3767961990241748793ul, 16186026923997330624ul,
           11525636434714970523ul, 1663752108284041390ul}},
    // C51
    // 25651603343685475797092525752511524795234780786110942738828507305471634791967
    {.l = {3001554249617149845ul, 1691306942129405379ul, 9885443994465018040ul,
           695536888940072249ul}},
    // C52
    // 48434698978712278012409706205559577163572452744833134361195687109159129985373
    {.l = {17988864203834009837ul, 9118104227235696829ul,
           10104371015638660658ul, 1918713587088085605ul}},
    // C53
    // 19216533213230709497947223526297848065365334472367022650183395435586190711770
    {.l = {15665743231794891668ul, 4074774633721145035ul, 5751734770019501564ul,
           1496575779898595127ul}},
    // C54
    // 28979268638217444507045957173243175542161823382530964742692324059406064069673
    {.l = {2312723600797978451ul, 12525916391323879817ul, 6935559899814037569ul,
           7388165308584075339ul}},
    // C55
    // 39595222492786803580155098254110905458620599931601547304699191792976275820627
    {.l = {16283968782100450924ul, 2254529700889645747ul, 4016269647194993920ul,
           7264418051915639580ul}},
    // C56
    // 32960510617530186159512413633821386297955642598241661044178889571655571939473
    {.l = {8360704106197291856ul, 4436663908069900342ul, 12210521579202648519ul,
           511843160031525084ul}},
    // C57
    // 7889715292813995933863223756089425964393897180189452806863798954507930091839
    {.l = {7644268123831292802ul, 10133662404191429166ul, 9272307393597511499ul,
           8173228715192871612ul}},
    // C58
    // 13352827863506000187484638938754778045801927238336090826457172216796844151715
    {.l = {12154647803602449193ul, 4226564838074935856ul, 2016105214691328975ul,
           114404396812479640ul}},
    // C59
    // 30947603548367054835673743723740015025005707671115631652801600587442201445177
    {.l = {11629117559365593437ul, 8044248154189145564ul, 3153259215497781979ul,
           7901250986828079766ul}},
    // C60
    // 12850897859166761094422335671106280470381427571695744605265713866647560628356
    {.l = {12579013181154747171ul, 2060841214762274663ul, 721551750131023491ul,
           4053551778778928434ul}},
    // C61
    // 38904040165181111823255670195939815931292647227116255264107979988806956289548
    {.l = {5885200498097083958ul, 13993775492071069314ul,
           10164593997304978347ul, 6992098247865246045ul}},
    // C62
    // 25006909110882547635888783363231997898678356998330081693721866800130170456647
    {.l = {11255539060163887757ul, 842420980730674830ul, 14038879796270143313ul,
           6227058081884367077ul}},
    // C63
    // 4013710873230826443116884915456609449978953338563445434409441681806815026730
    {.l = {2730748927051300478ul, 7308953621736205893ul, 14721181764699680802ul,
           584697628342967547ul}},
    // C64
    // 14578036872634298798382048587794204613583128573535557156943783762854124345644
    {.l = {490885040354948897ul, 3928912523636728580ul, 11620008694755109018ul,
           5567022720363307848ul}},
    // C65
    // 39889360541014555144282299111081174118245884910289471727743747142236304617512
    {.l = {7466772826924913842ul, 14892302803387926542ul, 6634195219601943203ul,
           2779812656467864104ul}},
    // C66
    // 24605471271485232528954711272624260971353798462604805288366835084266390771030
    {.l = {1753844478046684661ul, 3416390837758202956ul, 11689018473087486442ul,
           3762276427448381398ul}},
    // C67
    // 32848945739502266411559853130820445379864888538292863787526673996240608255581
    {.l = {5492017988807060788ul, 11191997549545852703ul, 9585194096870351511ul,
           6226435134600881383ul}},
    // C68
    // 21588109842058901916690548710649523388049643745013696896704903154857389904594
    {.l = {17221958730099159510ul, 2012012309820784034ul, 5840394014031503079ul,
           1632822489449101207ul}},
    // C69
    // 24621630539822708325987461182639243839218230216578207719742880580327336278872
    {.l = {7630164374740779199ul, 14180000725844557948ul, 3836946917704314199ul,
           736354103307917433ul}},
    // C70
    // 23292035053383468999937455955904141195196090231346729707163114096386939245045
    {.l = {17962661014700443851ul, 17944251621174833995ul,
           10736557065478750443ul, 5203121313775391949ul}},
    // C71
    // 34862495761319598342325758283475986703302067658762662103157742499522189663340
    {.l = {6773730770812803727ul, 3061318815383553661ul, 17866513551930134733ul,
           101780162694061781ul}},
    // C72
    // 35731638686520516424752846654442973203189295883541072759390882351699754104989
    {.l = {12101411954634896752ul, 4045609701959667708ul,
           18118227478942048702ul, 6933617356541239082ul}},
    // C73
    // 46440234052380105790888469652474218885021684932521963866506932102071884869246
    {.l = {1048761595342973026ul, 13002148767465843501ul,
           13361623581806110080ul, 301180847540648287ul}},
    // C74
    // 25090115689121901848391339168727470968622805959483871943497635575570652939181
    {.l = {2811619682455222838ul, 7803345527338144652ul, 8814039111568575080ul,
           3275540199831156886ul}},
    // C75
    // 40501241203084628430086902407426953152328601762975336410391868771614855492454
    {.l = {13614803558213487474ul, 10765879944884741584ul,
           14065367122856127273ul, 4914379777532757929ul}}};

static blst_fr ANEMOI_ROUND_CONSTANTS_D[76] = {
    // D0
    // 14981678621464625851270783002338847382197300714436467949315331057125308909900
    {.l = {15811495291530360453ul, 8161302378582868785ul,
           10379367933804585962ul, 75739460060754957ul}},
    // D1
    // 48720959343719104324739338388885839802998711550637402773896395605948383052052
    {.l = {9535501284687143741ul, 4367222479613845250ul, 7084153047754994928ul,
           3868949174363348160ul}},
    // D2
    // 11709610427641952476226704950218052763560489079301307464225164120801969364960
    {.l = {13900183351655292279ul, 9902183010455621674ul,
           17930217146902627450ul, 2524548184698268404ul}},
    // D3
    // 3188799073106888901912065951229864304299742047220134499402570163601813730969
    {.l = {2846774334160916107ul, 7108370949287253479ul, 560006239237054326ul,
           1062648362670562162ul}},
    // D4
    // 28253420209785428420233456008091632509255652343634529984400816700490470131093
    {.l = {9630914107757380667ul, 1258475103464374059ul, 4074185220593392298ul,
           2639960786484139527ul}},
    // D5
    // 6257781313532096835800460747082714697295034136932481743077166200794135826591
    {.l = {7939625641908935873ul, 99671362496425687ul, 11927264639823164096ul,
           6207370814703496234ul}},
    // D6
    // 11966422202069200811427605007493817363680804416274031195624148724039857787313
    {.l = {14489046482321363089ul, 9365763570094902627ul,
           13714054680743652460ul, 6034425173931152059ul}},
    // D7
    // 8876022912542631074912834764773050492660953075192093830253524158063181475941
    {.l = {584492899935184388ul, 14679422788514334559ul, 7125613446895921915ul,
           1203752031158328542ul}},
    // D8
    // 51511939407083344002778208487678590135577660247075600880835916725469990319313
    {.l = {7264967206210849666ul, 16143827440029857477ul, 110968098420048789ul,
           6404000683805083012ul}},
    // D9
    // 4386017178186728799761421274050927732938229436976005221436222062273391481632
    {.l = {2882172596194757012ul, 3159806628181860165ul, 17183081317546123311ul,
           2093092295739211243ul}},
    // D10
    // 663227665329044490605880474899933274574966982371072793854806732105730575244
    {.l = {8858176999061012174ul, 11856506610996493283ul, 9657390917825419066ul,
           2326170353836944320ul}},
    // D11
    // 7956955597245727322388196907364651338722736293265717471854714933795446618648
    {.l = {2589057803794092053ul, 8737936547248414954ul, 9422201217988035670ul,
           8190407565388121477ul}},
    // D12
    // 46291121544435738125248657675097664742296276807186696922340332893747842754587
    {.l = {9806438281233376676ul, 931394924840213202ul, 9442264819348743323ul,
           5082353730523088669ul}},
    // D13
    // 13820180736478645172746469075181304604729976364812127548341524461074783412926
    {.l = {7040585934045306773ul, 7354289843481753346ul, 5280142809714099405ul,
           5576779260195340556ul}},
    // D14
    // 21821175320697611197161277831984495658213397245419754392657307036488476373765
    {.l = {14709899060725851353ul, 6639912092133547531ul, 2639742291584427926ul,
           7842723122421675881ul}},
    // D15
    // 14806577897118234786495606424219372997573800509149076370951604526939593458489
    {.l = {4433407518420168450ul, 12839515653063362714ul, 6848154963125659180ul,
           689114425567488263ul}},
    // D16
    // 3650460179273129580093806058710273018999560093475503119057680216309578390988
    {.l = {17793909203631489560ul, 4784360104263992357ul, 8780195383945059211ul,
           4670215763352262479ul}},
    // D17
    // 40385222771838099109662234020243831589690223478794847201235014486200724862134
    {.l = {5095800894349755728ul, 8452642558887224657ul, 6810608226210837461ul,
           1708574651204421356ul}},
    // D18
    // 20738601554725926373596082603265918636164823648026470243422423735982938342408
    {.l = {16733749567220125396ul, 13411168829631302059ul,
           10759840371616251874ul, 1346636318663679656ul}},
    // D19
    // 25898290090014076279086638237202313571292864987698437102115051403552551578909
    {.l = {6468618268935569670ul, 6044298116116532269ul, 107025726289163467ul,
           2282717265738627691ul}},
    // D20
    // 45802223370746268123059159806400152299867771061127345631244786118574025749328
    {.l = {4745334327031885054ul, 15027568145872437618ul, 6820396973286859559ul,
           5523551184219637481ul}},
    // D21
    // 50306980075778262214155693291132052551559962723436936231611301042966928400825
    {.l = {11429642083302323342ul, 16883882679441158874ul,
           15275918991635319585ul, 1123526653027675143ul}},
    // D22
    // 9105861908793877437599087016640061747418296780065295891365798855886560153752
    {.l = {12230332171828810378ul, 5334289064130879267ul,
           17511878916216955701ul, 860324419576436679ul}},
    // D23
    // 48177591413367409915642056167048753041735583848456612607691620273026228709602
    {.l = {14091419344584271977ul, 18171569035145399313ul,
           9839519098664896195ul, 2334617478530153997ul}},
    // D24
    // 11798621276624967315721748990709309216351696098813162382053396097866233042733
    {.l = {12449731538627387747ul, 12531632181757593559ul,
           14222486200825963925ul, 7203063445117709109ul}},
    // D25
    // 34806952212038537244506031612074847133207330427265785757809673463434908473570
    {.l = {2389582180369459483ul, 17217091256637882809ul, 64583917304602817ul,
           8159999877164855362ul}},
    // D26
    // 10559431278588446438155840088055546145087872298641007742921718770142881700525
    {.l = {3920567458906927763ul, 17101672920424843211ul,
           18259555855586938872ul, 7418369590417111582ul}},
    // D27
    // 2511742758961381498086249076485723904703122022711664665388729650078747694082
    {.l = {10816133339822328379ul, 447176152081478556ul, 12859161289500289840ul,
           1990794548584610666ul}},
    // D28
    // 42372918959432199162670834641599336326433006968669415662488070504036922966492
    {.l = {15726611089689556459ul, 5795507155888605609ul, 3445565931366403624ul,
           1543995368721623802ul}},
    // D29
    // 22755759419530071315007011572076166983660942447634027701351681157370705921018
    {.l = {5227820122632648791ul, 10198096648605938547ul, 2797510967355293590ul,
           6986760993893981685ul}},
    // D30
    // 8881354201366797207686592249590682298565723459695719800911380560885170725516
    {.l = {14736219875933276386ul, 4400028784260965047ul, 6453357903743911444ul,
           8061423212245471335ul}},
    // D31
    // 19725785152035256359574211351446161592903393017031483635806025440159666669692
    {.l = {17592082877628178915ul, 8424852092878140601ul,
           12068928993732150018ul, 2942489765183644423ul}},
    // D32
    // 52181371244193189669553521955614617990714056725501643636576377752669773323445
    {.l = {5418445239864971111ul, 8754123880678542319ul, 3762767805934597682ul,
           3030763056320236985ul}},
    // D33
    // 30334172084294870556875274308904688414158741457854908094300017436690480001547
    {.l = {6116440096166461552ul, 3355860613786884162ul, 7418246458867003072ul,
           5929349113022334727ul}},
    // D34
    // 35548861917762862971011720475855172816698712671893796030607658203859222685056
    {.l = {10286378960265519223ul, 652429947494130402ul, 8429497565571926986ul,
           7349708086114788525ul}},
    // D35
    // 23828822166916376664523534857031979764654878164406016294521947902346141831375
    {.l = {14546199582818676945ul, 17963274510729307735ul,
           1097925802894547451ul, 313604424104124352ul}},
    // D36
    // 23791984554824031672195249524658580601428376029501889159059009332107176394097
    {.l = {10725566008572110773ul, 9300819939267475066ul,
           10713409829943209400ul, 8090793562345106443ul}},
    // D37
    // 19832360622723392584029764807971325641132953515557801717644226271356492507876
    {.l = {3990506041390126803ul, 17074956106623609427ul, 4109777950290240041ul,
           4608135649337820988ul}},
    // D38
    // 5370567718707734490084045178883836972105253285449736908577321570876055642415
    {.l = {75405468593058164ul, 16158385691575904399ul, 3584898129399241447ul,
           4092086313801712011ul}},
    // D39
    // 24072177097374519292068993110945703798030958684413852593268331853573451397392
    {.l = {1331488250423212470ul, 16273063961303363671ul, 5682771608532083064ul,
           2696369448511306897ul}},
    // D40
    // 33342520831620303764059548442834699069640109058400548818586964467754352720368
    {.l = {8048872697722111699ul, 6586539522841126025ul, 3522530155149444520ul,
           6701144923734735709ul}},
    // D41
    // 5828182614154296575131381170785760240834851189333374788484657124381010655319
    {.l = {2589779371950715447ul, 12462792024079026376ul,
           16849108535506618771ul, 3985405110802852845ul}},
    // D42
    // 35402840725731816569886401081547442120836676755165302266063041488580350955250
    {.l = {11523772183329627054ul, 14782132719181238674ul,
           14913119256804779399ul, 197159774959427697ul}},
    // D43
    // 7578125905794851322815150557558076805933581048787999755527104709377805399415
    {.l = {6285862049024908080ul, 5556645476722840347ul, 12546341678107027241ul,
           6578242774866555372ul}},
    // D44
    // 16791548253207744974576845515705461794133799104808996134617754018912057476556
    {.l = {14575492187598484303ul, 12453671724463651192ul,
           8246713543931304816ul, 4201146543640855641ul}},
    // D45
    // 23729797853490401568967730686618146850735129707152853256809050789424668284094
    {.l = {16896506122567896952ul, 2733007345868163240ul,
           15475131355651209124ul, 6065947805945305077ul}},
    // D46
    // 49370143532750679082722668747729303735386089710927180493816826667453179359307
    {.l = {8339270025766608830ul, 13703186283417623158ul, 2701400926860491539ul,
           924926589505260250ul}},
    // D47
    // 27097266715047947416989971035909786804213979341355151637537256791808468088871
    {.l = {9124976645433839360ul, 504978372077727554ul, 13038830488875537221ul,
           3555632192199924953ul}},
    // D48
    // 11087343419860825311828133337767238110556416596687749174422888171911517001265
    {.l = {13502703954848284088ul, 3943768041816546787ul, 131039509156825481ul,
           3120073282795300045ul}},
    // D49
    // 22848708497596347027267124890363029002241440143993561170521113640580467699956
    {.l = {5043002585693822893ul, 15475258332712740896ul, 8088278031252064980ul,
           5101529957059986381ul}},
    // D50
    // 46935663323261164382688860219844317191664211906631895718053635696150320980742
    {.l = {5569029087545829043ul, 7936823466780224435ul, 11471989326451399196ul,
           1030988964453397820ul}},
    // D51
    // 23315417868166174362767269296653794403481352182384787916982538955221505267261
    {.l = {10062484540989523236ul, 9465866796481598483ul,
           13077115487394293536ul, 4665157084316363051ul}},
    // D52
    // 11931207770538477937808955037363240956790374856666237106403111503668796872571
    {.l = {8986897760763454771ul, 7089904431347670909ul, 2139814013374435106ul,
           7716378250245333616ul}},
    // D53
    // 51131682674615117766578358255722474622484771145670260043231096654077231782319
    {.l = {8581178412682515671ul, 11590730909657541673ul, 3586966286653408046ul,
           460486326126763554ul}},
    // D54
    // 31450668283223561572076322313160106053568476742991897877225324875903002249604
    {.l = {8418180586921930355ul, 10260423053917834266ul,
           14905894881959070533ul, 368803028913279529ul}},
    // D55
    // 39920489769974701578396690596650849765810724821242337960210925107347402384997
    {.l = {9202544888583144353ul, 16012799675052899490ul,
           15231923230532873707ul, 4847439111451778142ul}},
    // D56
    // 3296943608590459582451043049934874894049468383833500962645016062634514172805
    {.l = {14022542500526828544ul, 12912847913272576175ul,
           9317208712459648801ul, 86263961955415746ul}},
    // D57
    // 46644788953432477700033739069823877324389237527251427373170202269468246508522
    {.l = {15223508142119008559ul, 9707258407508975941ul,
           12178783045752643816ul, 913895400187682690ul}},
    // D58
    // 22664151707746190750054384662981533360084484272555761134248875129763057677780
    {.l = {14477165544827006645ul, 6087030045126205049ul, 3993378055927579464ul,
           3578831974837225186ul}},
    // D59
    // 38112795024789026331454716650589784135071736234515159481572035998282603355681
    {.l = {764754425243859709ul, 1447573190562080132ul, 4684631759287107639ul,
           7614545044595310332ul}},
    // D60
    // 7080580976521357573320018355401935489220216583936865937104131954142364033647
    {.l = {10013221635359120038ul, 16177267925742072462ul,
           11838565692419617256ul, 3780202431764725053ul}},
    // D61
    // 49116488776967726165937498269670467876342398300299873421183016200344552693677
    {.l = {5236810571964668599ul, 6795029535994268742ul, 12325871283421924185ul,
           8238511643386412433ul}},
    // D62
    // 5775607906290870774969841847454953798015324758671395592282202609673663970158
    {.l = {5350426865558248683ul, 2308969485020983686ul, 7888516474188664016ul,
           1490198651506569229ul}},
    // D63
    // 35072152475947120994856911110488544982789945128612254676552168689163078109193
    {.l = {2085499926513954545ul, 6352521363886262426ul, 11816137043811048329ul,
           450221537172104071ul}},
    // D64
    // 25990144965911478244481527888046366474489820502460615136523859419965697796405
    {.l = {7082935381019747451ul, 13409420108194203116ul, 2162895577432005ul,
           5237983099801576675ul}},
    // D65
    // 14848358953597561974718183292582367067672986399629388709956782223452089882598
    {.l = {15976224787252924170ul, 3057637720888802707ul, 4507356837962169879ul,
           3970535778441502699ul}},
    // D66
    // 22556595042816138635237566372803723712758669139630055834668828463426654330011
    {.l = {5006574165606503979ul, 6281179624164270852ul, 4941758381889059636ul,
           7323243582987505109ul}},
    // D67
    // 28653937143014953451053935433622921917053230744497971854807399873275060199001
    {.l = {14004610874730140542ul, 5599646165273585973ul, 2392033708224999876ul,
           6036268769882490114ul}},
    // D68
    // 33907313384235729375566529911940467295099705980234607934575786561097199483218
    {.l = {13635259357895193414ul, 7503773473633967881ul, 7337684202619391550ul,
           852357166818562430ul}},
    // D69
    // 487724401305363169199847265179218834788702012213977760246723410671357671821
    {.l = {5960866622200024877ul, 16803333296310695040ul,
           14825244523830106358ul, 1475651523212748424ul}},
    // D70
    // 22150254273614023118996812957122385982744331214667833311755915224675438931889
    {.l = {11036640989391498519ul, 16820293986836611202ul,
           17104432962045889121ul, 8312662767245708056ul}},
    // D71
    // 31574582613731933394596342487317245286633780171263623228729276125684877734623
    {.l = {5107573939572151536ul, 17961124492614630161ul, 9032963975980568618ul,
           7813704955371312261ul}},
    // D72
    // 25996950265608465541351207283024962044374873682152889814392533334239395044136
    {.l = {12027257987959925002ul, 10811558767416674265ul,
           8451328163049581367ul, 4860546105390490080ul}},
    // D73
    // 252435950773882291823235162305238814727672291548639924141542508715737622718
    {.l = {2892009244036245755ul, 4487084574404333990ul, 16876950582091318087ul,
           8101389198389718405ul}},
    // D74
    // 1894442946263577625173075597236760690306562506195881565221204280158983986548
    {.l = {17844889136384823468ul, 7953575794643744568ul, 4017725503655357952ul,
           5092475724781262768ul}},
    // D75
    // 15159436092408085140079866038559256669795829838867203553094169974077374924260
    {.l = {15461192136796796924ul, 2458970041512006875ul, 8823153217495985316ul,
           2980181782225348831ul}}};

void anemoi_jive128_1_compress(blst_fr *res, blst_fr *x, blst_fr *y);

void anemoi_jive_apply(anemoi_ctxt_t *ctxt);

blst_fr *anemoi_get_state_from_context(anemoi_ctxt_t *ctxt);

int anemoi_get_state_size_from_context(anemoi_ctxt_t *ctxt);

blst_fr *anemoi_get_mds_from_context(anemoi_ctxt_t *ctxt);

blst_fr *anemoi_get_round_constants_from_context(anemoi_ctxt_t *ctxt);

#endif
