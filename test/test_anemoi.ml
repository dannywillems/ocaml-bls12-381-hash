(* Generated using
   https://github.com/vesselinux/anemoi-hash/commit/9d9fc2a52e31c5e9379be2856414233e4e780f58
   with:
       test_jive(
           n_tests=10,
           q=52435875175126190479447740508185965837690552500527637822603658699938581184513,
           alpha=5,
           n_rounds=19,
           n_cols=1,
           b=2,
           security_level=128)
*)

let test_vectors () =
  let vectors =
    [ ( ( "35845669682800269995209049467553751861599775089532198376674489477778357560569",
          "28310433413288793552092391706285055875131165883761155923425672020460794794380"
        ),
        "17700999234906509130159287769741962009709982288860491609792036961305502635098"
      );
      ( ( "13880477308466057091493501926554391163288910083198657398974047674796581779693",
          "28373522553669637689090633983852091038187643792080489433228018701827926002768"
        ),
        "12743339877423634016102198261148085947154915493891480470390198918335851344292"
      );
      ( ( "38216845839357573472239023564373200263918534132389374505946789120458119648667",
          "39487400661842934211797098190376905462917596530484823725006452014098066670694"
        ),
        "20572002340893814224552312721780888755123139461240945499350006876769919946773"
      );
      ( ( "31131499311453094268713009639057190648340672035944963596113874024605484784791",
          "43680468547604090714590688733926978605538499294774749079842255618079617105051"
        ),
        "20569340066597303483907565303221880873948750088343130268109858923675035314078"
      );
      ( ( "10924450358499789254279737793602938412226831772739559590509902641736698048741",
          "18748800755846695314043868352493820136560550891447333332696158632417495012819"
        ),
        "26749108456690136523602417383379636205348260403407066884482315588658233098940"
      );
      ( ( "46462878845927326448614772124701161417983809741866268465266076023457688715870",
          "38375603405434266869135117417290149314037130980580543700755400748014512343979"
        ),
        "2673364003345693113273421176038865068057650274048787980068125230806361632850"
      );
      ( ( "39170732922513369978795230271067076371378632409257775938940964299534787717175",
          "2408517610992178001486942104041564424468943886715588829396035415376300986469"
        ),
        "13310229620063667311431399083462393119055434191991960510670894258662703203975"
      ) ]
  in
  List.iter
    (fun ((x1_s, x2_s), exp_res_s) ->
      let x1 = Bls12_381.Fr.of_string x1_s in
      let x2 = Bls12_381.Fr.of_string x2_s in
      let exp_res = Bls12_381.Fr.of_string exp_res_s in
      let res = Bls12_381_hash.Anemoi.jive128_1_compress x1 x2 in
      if not (Bls12_381.Fr.eq res exp_res) then
        Alcotest.failf
          "Expected result = %s, computed result = %s, input = (%s, %s)"
          exp_res_s
          (Bls12_381.Fr.to_string res)
          x1_s
          x2_s)
    vectors

let () =
  let open Alcotest in
  run
    "Anemoi"
    [ ( "Test vectors",
        [test_case "from reference implementation" `Quick test_vectors] ) ]
