(* Generated using
   https://github.com/vesselinux/anemoi-hash/commit/9d9fc2a52e31c5e9379be2856414233e4e780f58
   with:
       test_jive(
           n_tests=10,
           q=52435875175126190479447740508185965837690552500527637822603658699938581184513,
           alpha=5,
           n_rounds=10,
           n_cols=1,
           b=2,
           security_level=128)
*)

let test_vectors () =
  let vectors =
    [ ( ( "12274535646733235648294674615870135194307446623282589284978761144974127229642",
          "33692263434367257032362183569562991089833794932863504663861512677533746390891"
        ),
        "9772833875406184836991800733691429118032862485855348779074725563470697587909"
      );
      ( ( "5779824467290194039467204054462208923114629076604469388162110779301533156923",
          "5713238815416175136190252862238282463311682211916270362726608068184822995462"
        ),
        "21571976327178899739684045990221505317987443951649702194247812066731527254848"
      );
      ( ( "46323962000276648078189340221222517843413645516719727853551223903852060297852",
          "7670106404971673505924964464824919723273579340511025263654370691476037051411"
        ),
        "50800681232510129595156711301831401987025593526804955922358262993738757285885"
      );
      ( ( "41974665403841525290270618104143208869715009923928884086851423907968597642753",
          "30187819201569455669427492217407468378585757178909525345726050790313355856950"
        ),
        "14859781063738983222894997787197364103051955925757261379925129101985603094700"
      );
      ( ( "16189777289671425740719675368578184707156009987847267966585976020389461399684",
          "38032946174793055329039689753134213147112614970058982064513978218023185069476"
        ),
        "26194678777713154373990585401205965998826239920378416023128553037240601751304"
      );
      ( ( "21176775621431166474607855509910860797951582447219202860333161611010733388485",
          "17798580310858315500433553787187582914185714591123033502033607806460798676953"
        ),
        "3989934722597464587729963670845310496052756360794949924671308736525006461032"
      );
      ( ( "48539369185654756520320936228594085381088160470845196737384726600813262026859",
          "19352476881523154909843755256990826887354197189875161961836550790825781353875"
        ),
        "27291905385672133630647049664546103536873978131250914600022590178246508313991"
      ) ]
  in
  List.iter
    (fun ((x1_s, x2_s), exp_res_s) ->
      let x1 = Bls12_381.Fr.of_string x1_s in
      let x2 = Bls12_381.Fr.of_string x2_s in
      let exp_res = Bls12_381.Fr.of_string exp_res_s in
      let res = Bls12_381_hash.Anemoi.jive128_1_compress x1 x2 in
      if not (Bls12_381.Fr.eq res exp_res) then
        Alcotest.failf
          "Expected result = %s, computed result = %s, input = (%s, %s)"
          exp_res_s
          (Bls12_381.Fr.to_string res)
          x1_s
          x2_s)
    vectors

let () =
  let open Alcotest in
  run
    "Anemoi"
    [ ( "Test vectors",
        [test_case "from reference implementation" `Quick test_vectors] ) ]
